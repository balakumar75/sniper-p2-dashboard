<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sniper Trades</title>
  <style>
    body { font-family: Arial; background: #111; color: #eee; padding: 20px; }
    h1 { color: #2ecc71; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #444; padding: 8px; text-align: center; }
    th { background: #333; }
    tr:nth-child(even) { background: #1a1a1a; }
    .buy { color: #2ecc71; font-weight: bold; }
    .sell { color: #e74c3c; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Sniper Trades</h1>
  <div id="trade-table">Loading trades...</div>

  <script>
    async function loadTrades() {
      try {
        const response = await fetch('/api/trades');
        const trades = await response.json();

        if (!trades.length) {
          document.getElementById('trade-table').innerHTML = '<p>No trades found.</p>';
          return;
        }

        let html = '<table><thead><tr>' +
          '<th>Date</th><th>Symbol</th><th>Type</th><th>Entry</th><th>CMP</th>' +
          '<th>Target</th><th>SL</th><th>PoP</th><th>Status</th><th>PnL</th><th>Action</th>' +
          '</tr></thead><tbody>';

        for (const trade of trades) {
          html += `<tr>
            <td>${trade.date}</td>
            <td>${trade.symbol}</td>
            <td>${trade.type}</td>
            <td>${trade.entry}</td>
            <td>${trade.cmp}</td>
            <td>${trade.target}</td>
            <td>${trade.sl}</td>
            <td>${trade.pop}</td>
            <td>${trade.status}</td>
            <td>${trade.pnl ?? '-'}</td>
            <td class="${trade.action === 'Buy' ? 'buy' : 'sell'}">${trade.action}</td>
          </tr>`;
        }

        html += '</tbody></table>';
        document.getElementById('trade-table').innerHTML = html;

      } catch (err) {
        document.getElementById('trade-table').innerHTML = '<p>‚ùå Failed to load trades.</p>';
        console.error('Error fetching trades:', err);
      }
    }

    loadTrades();
  </script>
</body>
</html>
